
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Installing the SpecFlow Visual Studio Extension</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="Setup"
                  title="Installing the SpecFlow Visual Studio Extension"
                  environment="web"
                  feedback-link="">
    
      <google-codelab-step label="A New SpecFlow Project" duration="0">
        <p> Once the SpecFlow extension has been installed, the option to create a SpecFlow project will be available from the New Project dialog. It can be found under the Visual C# root menu. Enter an appropriate name and location and click Ok.   <img alt="alt_text" title="image_tooltip" src="img\5e4552b4938e759b.png">   A dialog will then be displayed with configuration options for the SpecFlow project. Set the Framework to 4.6.2 and the Test Framework to NUnit.   <img alt="alt_text" title="image_tooltip" src="img\11334334830466a.png">   The solution will then be opened with the standard folder structure for a SpecFlow project, and some test files which can be deleted. Visual Studio should have also resolved the required NuGet packages for the project.   <img alt="alt_text" title="image_tooltip" src="img\43197ca0a1506953.png">   </p>


      </google-codelab-step>
    
      <google-codelab-step label="Installing Capgemini.PowerApps.Bindings" duration="0">
        <p> The next step in creation of the project is installing the Capgemini PowerApps Bindings from NuGet. This can be done either through the command line or through the UI.   </p>
<h2 is-upgraded>Command Line </h2>
<p> Enter the following into the Package Manager Console in Visual Studio:   <br><code>PM&gt; Install-Package Capgemini.PowerApps.SpecFlowBindings</code><br>    </p>
<h2 is-upgraded>UI </h2>
<p> Right click on the new solution in Solution Explorer and click &#34;Manage NuGet Packages for Solution&#34;.  <img alt="alt_text" title="image_tooltip" src="img\49b365c6b68379dd.png">   Once the NuGet Package Manager window has opened, click the Browse tab and search for &#34;Capgemini.PowerApps.Bindings&#34;. Select the package, right click the SpecFlow project and click Install.   <img alt="alt_text" title="image_tooltip" src="img\1688c9d203302de6.png">    </p>
<h2 is-upgraded>Capgemini Project Setup </h2>
<p> Once the NuGet package has been installed, create a SpecFlow Configuration JSON file named specflow.json in the root of the project. The below code must be added to the specflow.json file to allow the external bindings to be used in the project. Create or update the specflow.json file with the below code.   &#34;` { </p>
<pre><code>&#34;stepAssemblies&#34;: [
    { &#34;assembly&#34;: &#34;Capgemini.PowerApps.SpecFlowBindings&#34; }
]
//additional json attributes as required
</code></pre>
<p>} &#34;`   Next, create a file called &#34;power-apps-bindings.yml&#34; in the root directory of the project. This is the file used to configure settings used by the Capgemini.PowerApps.Bindings project.   </p>
<h2 is-upgraded>Driver Setup </h2>
<p> To set up a driver for the project, install your preferred browser driver via NuGet. This lab will be using ChromeDriver.   <img alt="alt_text" title="image_tooltip" src="img\57430e1a1358db3c.png">   </p>
<p>Connecting to a Dynamics Instance </p>
<p> Connecting to Dynamics is handled by the Capgemini bindings, using the login and data setup steps. The connection is configured using the power-apps-bindings.yml file. It is recommended to use environment variables in this file rather than actual values, to avoid storing sensitive information in a shared repository. Create or update the  power-apps-bindings.yml file with the following information:   &#34;` url: SPECFLOW_LAB_URL browserOptions:   browserType: Chrome #If using another driver, update this here   headless: true   width: 1920   height: 1080   startMaximized: false applicationUser:   tenantId: SPECFLOW_LAB_TENANTID   clientId: SPECFLOW_LAB_CLIENTID   clientSecret: SPECFLOW_LAB_CLIENTSECRET users: </p>
<ul>
<li>username: SPECFLOW_LAB_USERNAME password: SPECFLOW_LAB_PASSWORD alias: a basic user </li>
<li>username: SPECFLOW_LAB_IMPERSONATED alias: an impersonated user  &#34;`      Environment Variables    The environment variables for this lab should be set to the details of the test Dynamics instance provided. Visual Studio must be restarted for changes to environment variables to take effect.     BrowserOptions    The parameters in the browserOptions section are used to determine how the tests will be executed. For this lab, ChromeDriver will be used, so the browserType is set to Chrome. The headless parameter defines whether the test will be visible to the user in a Chrome window when running. When using automated UI testing as part of a DevOps pipeline, this should always be set back to true before committing to the repository. However, changing this setting to false is a useful way to debug failing or flaky tests.     Users    The application user in this instance must have the permissions to impersonate users, and uses a client id and secret rather than username and password. Users to be impersonated do not require a password in the yml file.     Testing the Dynamics Connection    The Dynamics connection can be tested by creating a scenario and including the below step:   <br><code>Given I am logged in to the &#39;UI Test App&#39; app as &#39;a basic user&#39;</code><br>   To do this, create a new SpecFlow Feature file in the Features folder of the project as below:    <br><code>Feature: Test Connection<br><br>Scenario: Test Connection Scenario<br>Given I am logged in to the &#39;UI Test App&#39; app as &#39;a basic user&#39;</code><br>   Now build the project and run this scenario using the Test Explorer window in Visual Studio.   <img alt="alt_text" title="image_tooltip" src="img\ebc71b2153de6049.png">   After around 30 seconds the test should pass; clicking the test and opening the &#34;Output&#34; link in the test summary should show that the step in the scenario was successfully completed.   <img alt="alt_text" title="image_tooltip" src="img\d0f2f3b19425eff7.png">   This proves that the connection to Dynamics was successful and the environment variables have been set correctly. </li>
</ul>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/codelab-elements/native-shim.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/prettify.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
